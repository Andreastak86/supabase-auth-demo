name: Keep Supabase Awake

on:
   schedule:
      - cron: "0 7 * * *"
   workflow_dispatch: {}

jobs:
   ping:
      runs-on: ubuntu-latest
      steps:
         - name: Print URL (maskes av GitHub)
           run: |
              echo "Using SUPABASE_URL=${SUPABASE_URL}"
           env:
              SUPABASE_URL: ${{ secrets.SUPABASE_URL }}

         - name: Curl ping Supabase REST endpoint
           run: |
              echo "Pinging ${SUPABASE_URL}/auth/v1/health"
              STATUS=$(curl -s -o /dev/null -w "%{http_code}" "${SUPABASE_URL}/auth/v1/health")
              echo "HTTP status: $STATUS"
              if [ "$STATUS" -ne 200 ]; then
                echo "Supabase svarte ikke med 200 â€“ noe er rart ðŸ¤”"
                exit 1
              fi
           env:
              SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
